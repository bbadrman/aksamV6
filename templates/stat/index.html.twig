{% extends 'base.html.twig' %}

{% block title %}Les Statistiques des prospects!
{% endblock %}

{% block body %}
	<section class="content-header">
		{% if app.request.get('_route') == 'newprospect_index' %}
			<h2>Nouveaux Prospects</h2>
		{% elseif app.request.get('_route') == 'prospect_search' %}
			<h2>Tous Prospects</h2>
		{% elseif app.request.get('_route') == 'relancejour_index' %}
			<h2>Les Relances du Jour</h2>
		{% elseif app.request.get('_route') == 'relancenotraite_index' %}
			<h2>Les Relances Non Traités</h2>
		{% elseif app.request.get('_route') == 'avenir_index' %}
			<h2>Les Relances à venir</h2>
		{% elseif app.request.get('_route') == 'app_unjoinable' %}
			<h2>Les Injoignables</h2>
		{% elseif app.request.get('_route') == 'notrait_index' %}
			<h2>Les Prospects Non Traités</h2>
		{% elseif app.request.get('_route') == 'app_client' %}
			<h2>Les Clients</h2>
		{% endif %}
		<ol class="breadcrumb">
			<li>
				<a href="{{ path('dashboard') }}">
					<i class="fa fa-dashboard"></i>
					Tableau de bord</a>
			</li>
			<li class="active">
				<a href="{{ path('app_table_liste') }}">
					<i class="fa fa-users"></i>
					Toutes les Tables</a>
			</li>
			<!-- NOTIFICATION DROPDOWN -->

			<li id="header_notification_bar" class="dropdown">
				<a data-toggle="dropdown" class="dropdown-toggle" href="#">
					<i class="fa fa-shopping-cart"></i>

				</a>

			</li>
			<!-- END NOTIFICATION DROPDOWN -->
		</ol>
		<br>
	</section>

	<div class="row mt">
		<div class="col-lg-12">
			<div class="content-panel">


				<hr>

				<table class="table table-striped table-advance table-hover">
					<thead>

						<tr>


							<th>Equipe</th>
							<th>Saisie manum</th>
							<th>Revendeur</th>
							<th>Assuré actuellement o/n</th>
							<th>Type Pospect particul</th>
							<th>Type Pospect profsl</th>
							<th>Faux Fiche</th>
							<th>Doublon</th>
							<th>Passage Concurrent</th>
							<th>Passage Contrat</th>
							<th>Déjà Souscrit</th>
							<th>Unjoing</th>
							<th>Attente Close</th>

							<th>Action</th>

						</tr>
					</thead>


					<tbody>

						{% for teams in team %}
							<tr style="text-align:left;">


								<td>
									<span class="btn btn">
										{{ ( teams.name) }}

										{#  {{ render(controller('App\\Controller\\DashboardController::listShow',{'id':teams.id}))}} #}
									</span>
								</td>
								<td>
									{{ ( teams.prospects | length) }}
									{# du mois  #}
									m{{ " %02d"|format(teams.prospects|filter(p => p.comrcl is not null and p.creatAt|date('Y-m') == "now"|date('Y-m'))|length) }}
									{# du semaine  #}
									s{{ " %02d"|format(teams.prospects|filter(p => p.comrcl is not null and p.creatAt|date('W') == "now"|date('W'))|length) }}
									{# du year  #}
									y{{ " %02d"|format(teams.prospects|filter(p => p.comrcl is not null and p.creatAt|date('Y') == "now"|date('Y'))|length) }}

								</td>
								<td>
									<span
										class="btn btn">
										{# {{ ( teams.name) }} #}

										{{ render(controller('App\\Controller\\DashboardController::listShow',{'id':teams.id}))}}
									</span>
								</td>


								<td>
									<span class="btn btn-primary">
										<strong>
											{# {{ "%02d"|format(teams.prospects |length) }} #}
											{{ " %02d"|format( teams.prospects|filter(p =>  p.comrcl is  null and p.team is not null and p.creatAt|date('Y-m-d') == "now"|date('Y-m-d'))|length) }}
											{# {{ teams.prospects.creatAt|date('Y-m-d') == 'now'|date('Y-m-d') }} #}
										</strong>

									</span>
								</td>

								{# <td> <span class="btn btn-danger"> {{ " %02d"|format(teams.prospects|filter(p => p.comrcl is null  )| length)  }}   </span>  </td>
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														  #}
								<td>
									<span class="btn btn-primary">
										<strong>

											<strong>
												{{ " %02d"|format( teams.prospects|filter(p =>  p.comrcl is not null  )|length) }}

												{# affichi du mois #}
												m{{ " %02d"|format( teams.prospects|filter(p => p.comrcl is not null and p.creatAt|date('Y-m') == "now"|date('Y-m'))|length) }}
												{# affichi d' année #}
												y{{ " %02d"|format( teams.prospects|filter(p => p.comrcl is not null and p.creatAt|date('Y') == "now"|date('Y'))|length) }}
												{# affichi du semaine #}
												s{{ " %02d"|format( teams.prospects|filter(p => p.comrcl is not null and p.creatAt|date('W') == "now"|date('W'))|length) }}


											</strong>
										</span>
									</td>
								</td>
								<td>
									<span class="btn btn-danger">
										<strong>
											{{ " %02d"|format( teams.prospects|filter(p => p.motifSaise == 1  )|length) }}
										</strong>
									</span>
								</td>

								<td>
									<span class="btn btn-success day">
										<strong>
											{{ " %02d"|format( teams.prospects|filter(p => p.motifSaise ==  2  )|length) }}


										</strong>
									</span>
								</td>


								<td>
									<span class='btn btn' style="background-color:Violet;">
										<strong>{{ " %02d"|format( teams.prospects|filter(p => p.motifSaise == 4   )|length) }}
										</strong>
									</span>
								</td>


								<td>
									<span class='btn btn' style="background-color:GreenYellow;">
										<strong>
											{{ " %02d"|format( teams.prospects|filter(p =>  p.source == 'Propre site'  )|length) }}</strong>
									</span>
								</td>

								<td>
									<span class='btn btn' style="background-color:Aquamarine;">
										<strong>
											{{ " %02d"|format( teams.prospects|filter(p =>  p.source == 'Revendeur'   )|length) }}
										</strong>
									</span>
								</td>

							</tr>
						{% endfor %}


					</tbody>
				</table>

			</div>
		</div>
	</div>
{% endblock %}
