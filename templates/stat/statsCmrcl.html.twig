{# templates/prospect/stats_by_team.html.twig #}

{% extends 'base.html.twig' %}

{% block title %}Stat Commercial
{% endblock %}

{% block body %}

	<p>Choisir une année :</p>
	<ul>
		{% for y in (currentYear - 1)..(currentYear  ) %}

			<a class="btn btn-success day" href="{{ path('prospects_stats_cmrcl', {'year': y, 'month': month}) }}">{{ y }}</a>

		{% endfor %}
	</ul>

	<p>Choisir un mois :</p>
	<ul>
		{% for m in 1..12 %}

			<a class="btn btn-success day" href="{{ path('prospects_stats_cmrcl', {'year': year, 'month': m}) }}">{{ m }}</a>

		{% endfor %}
	</ul>
	<h1>Statistiques des prospects par équipe pour
		{{ month }}/{{ year }}</h1>

	<table id="ma-table" class="table table-striped table-advance table-hover">
		<thead>

			<tr style="text-align: center;">
				<th rowspan="2" style="background-color:#00FFFF;">Equipe</th>
				<th rowspan="2" style="background-color:#18B7BE;">Commercial</th>
				<th rowspan="2" style="background-color:#FFD700;">Total</th>
				<th colspan="3" style="background-color:#d9534f;">Source</th>
				<th colspan="2" style="background-color:#5cb85c;">Type Prospect</th>

				<th colspan="6" style="background-color:#41B9E1;">Motive de saisier</th>
				<th colspan="8" style="background-color:Violet;">Activites</th>
			</tr>
			<tr style="text-align: center;">

				<th style="background-color:#d9534f;">Saisier</th>
				<th style="background-color:#d9534f;">Site Pub</th>
				<th style="background-color:#d9534f;">Revedeur</th>

				<th style="background-color:#5cb85c;">Particulier</th>
				<th style="background-color:#5cb85c;">Professionnel</th>


				<th style="background-color:#41B9E1;">Parrainage</th>
				<th style="background-color:#41B9E1;">Appel
				</th>
				<th style="background-color:#41B9E1;">Avenant</th>
				<th style="background-color:#41B9E1;">Ancienne</th>
				<th style="background-color:#41B9E1;">Propre site</th>
				<th style="background-color:#41B9E1;">Revendeur</th>


				<th style="background-color:Violet;">TPM</th>
				<th style="background-color:Violet;">VTC</th>
				<th style="background-color:Violet;">Sociéte</th>
				<th style="background-color:Violet;">Décenale</th>
				<th style="background-color:Violet;">Dommage</th>
				<th style="background-color:Violet;">Marchandise</th>
				<th style="background-color:Violet;">Négociant</th>
				<th style="background-color:Violet;">Prof Auto</th>

			</tr>
		</thead>

		<tbody>

			{% set previousTeam = '' %}
			{% for teamName, teamData in prospectsByTeam %}
				{% for comrclName, prospects in teamData %}

					<tr style="text-align:left;">
						<td>
							{% if teamName != previousTeam %}

								<button class="btn btn" style="background-color:#00FFFF;">
									{{ teamName }}

								</button>

							{% endif %}
						</td>
						<td>
							<button class="btn btn" style="background-color:#18B7BE;">

								{{ comrclName }}
							</button>
						</td>
						<td>
							<span class="btn btn " style="background-color:#FFD700;">{{ " %02d"|format(prospects|length  )}}</span>
						</td>
						<td>
							<span class="btn btn-danger">{{ " %02d"|format(  prospects|filter(p => p.source == 1  )|length )}}</span>
						</td>
						<td>
							<span class="btn btn-danger">{{ " %02d"|format(  prospects|filter(p => p.source is null  )|length )}}</span>
						</td>
						<td>
							<span class="btn btn-danger">{{ " %02d"|format(  prospects|filter(p => p.source == 2  )|length )}}</span>
						</td>
						<td>
							<span class="btn btn-success day">{{ " %02d"|format(  prospects|filter(p => p.typeProspect == 1  )|length )}}</span>
						</td>
						<td>
							<span class="btn btn-success day">{{ " %02d"|format(  prospects|filter(p => p.typeProspect == 2  )|length )}}</span>
						</td>

						<td>
							<span class="btn btn" style="background-color:#41B9E1;">{{ " %02d"|format(  prospects|filter(p => p.motifSaise == 1  )|length )}}</span>
						</td>
						<td>
							<span class="btn btn" style="background-color:#41B9E1;">{{ " %02d"|format(  prospects|filter(p => p.motifSaise == 2  )|length )}}</span>
						</td>
						<td>
							<span class="btn btn" style="background-color:#41B9E1;">{{ " %02d"|format(  prospects|filter(p => p.motifSaise == 3  )|length )}}</span>
						</td>
						<td>
							<span class="btn btn" style="background-color:#41B9E1;">{{ " %02d"|format(  prospects|filter(p => p.motifSaise == 4  )|length )}}</span>
						</td>
						<td>
							<span class="btn btn" style="background-color:#41B9E1;">{{ " %02d"|format(  prospects|filter(p => p.motifSaise == 5  )|length )}}</span>
						</td>
						<td>
							<span class="btn btn" style="background-color:#41B9E1;">{{ " %02d"|format(  prospects|filter(p => p.motifSaise == 6  )|length )}}</span>
						</td>

						<td>
							<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format(  prospects|filter(p => p.activites == 1  )|length )}}</span>
						</td>
						<td>
							<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format(  prospects|filter(p => p.activites == 2  )|length )}}</span>
						</td>
						<td>
							<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format(  prospects|filter(p => p.activites == 3  )|length )}}</span>
						</td>
						<td>
							<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format(  prospects|filter(p => p.activites == 4  )|length )}}</span>
						</td>
						<td>
							<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format(  prospects|filter(p => p.activites == 5  )|length )}}</span>
						</td>
						<td>
							<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format(  prospects|filter(p => p.activites == 6  )|length )}}</span>
						</td>
						<td>
							<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format(  prospects|filter(p => p.activites == 7  )|length )}}</span>
						</td>
						<td>
							<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format(  prospects|filter(p => p.activites == 8  )|length )}}</span>
						</td>

					</tr>
					{% set previousTeam = teamName %}
				{% endfor %}
			{% endfor %}
			<tr>
				<td colspan="2">
					<button class="btn btn-primary">Total Prospects :
					</button>
				</td>

				<td>
					<span class="btn btn-primary">
						{{ prospects|filter(p => p.team is not null  )|length }}</span>
				</td>

				<td>
					<span class="btn btn-danger">{{ " %02d"|format( prospects|filter(p => p.source == 1 and p.team is not null  )|length ) }}</span>
				</td>
				<td>
					<span class="btn btn-danger">{{ " %02d"|format( prospects|filter(p => p.source is null and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class="btn btn-danger">{{ " %02d"|format( prospects|filter(p => p.source == 2 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class="btn btn-success day">{{ " %02d"|format(prospects|filter(p => p.typeProspect == 1 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class="btn btn-success day">{{ " %02d"|format( prospects|filter(p => p.typeProspect == 2 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class="btn btn" style="background-color:#41B9E1;">{{ " %02d"|format( prospects|filter(p => p.motifSaise == 1 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class="btn btn" style="background-color:#41B9E1;">{{ " %02d"|format( prospects|filter(p => p.motifSaise == 2 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class="btn btn" style="background-color:#41B9E1;">{{ " %02d"|format( prospects|filter(p => p.motifSaise == 3 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class="btn btn" style="background-color:#41B9E1;">{{ " %02d"|format( prospects|filter(p => p.motifSaise == 4 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class="btn btn" style="background-color:#41B9E1;">{{ " %02d"|format( prospects|filter(p => p.motifSaise == 5 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class="btn btn" style="background-color:#41B9E1;">{{ " %02d"|format( prospects|filter(p => p.motifSaise == 6 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format( prospects|filter(p => p.activites == 1 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format( prospects|filter(p => p.activites == 2 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format( prospects|filter(p => p.activites == 3 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format( prospects|filter(p => p.activites == 4 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format( prospects|filter(p => p.activites == 5 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format( prospects|filter(p => p.activites == 6  and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format( prospects|filter(p => p.activites == 7 and p.team is not null )|length ) }}</span>
				</td>
				<td>
					<span class='btn btn' style="background-color:Violet;">{{ " %02d"|format( prospects|filter(p => p.activites == 8 and p.team is not null )|length ) }}</span>
				</td>

			</tr>
		</tbody>
	</tbody>
</table>{% endblock %}
